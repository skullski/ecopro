<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Build Your PC â€” ElectroStore DZ</title>

  <!-- Tailwind CDN (for preview). Use a built build in production. -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Reuse the futuristic tokens from store */
    :root{
      --bg:#0b1220; --surface:rgba(255,255,255,0.03); --muted:#9aa7bf; --text:#e6eef8;
      --neon-cyan:#00f0ff; --neon-indigo:#6c5ce7; --neon-magenta:#ff4db4;
      --card-shadow:0 12px 40px rgba(2,6,23,0.6); --glow:0 8px 40px rgba(0,240,255,0.08);
    }
    [data-theme="light"]{
      --bg:linear-gradient(180deg,#f6f9fc,#eef6ff); --surface:rgba(255,255,255,0.85); --muted:#475569; --text:#071033;
      --card-shadow:0 10px 30px rgba(2,6,23,0.06); --glow:0 8px 40px rgba(108,92,231,0.06);
    }
    body{background:var(--bg); color:var(--text); font-family:Inter,system-ui,Segoe UI,Roboto,Arial; -webkit-font-smoothing:antialiased;}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; box-shadow:var(--card-shadow);}
    .muted{color:var(--muted)}
    .badge { background: linear-gradient(90deg,var(--neon-cyan),var(--neon-indigo)); color:#021; padding:6px 10px; border-radius:999px; font-weight:700; }
    .cta { background:var(--surface); color:var(--text); padding:.6rem 1rem; border-radius:10px; font-weight:800; box-shadow:var(--glow); }
    .compat-ok { color: #34d399; font-weight:700; }
    .compat-bad { color: #fb7185; font-weight:700; }
    .perf-bar { height:10px; border-radius:999px; background:linear-gradient(90deg,#06b6d4,#3b82f6); }
  </style>
</head>
<body>

  <!-- Header (consistent with store) -->
  <header class="sticky top-0 z-40 header-glass">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center gap-6">
      <a href="store.html" class="flex items-center gap-3">
        <div style="width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#6c5ce7,#00f0ff);display:flex;align-items:center;justify-content:center;color:white;font-weight:700">E</div>
        <div>
          <div class="font-semibold">ElectroStore DZ</div>
          <div class="text-xs muted">Build Your PC</div>
        </div>
      </a>

      <div class="ml-auto flex items-center gap-4">
        <button id="themeToggle" class="p-2 rounded-md hover:bg-white/6" aria-label="Toggle theme">Theme</button>
        <button id="cartBtn" class="relative p-2 rounded-md hover:bg-white/6">ðŸ›’ <span id="cartCount" class="absolute -top-1 -right-1 bg-pink-500 text-white text-xs rounded-full px-1.5">0</span></button>
      </div>
    </div>
  </header>

  <!-- Page header -->
  <main class="max-w-7xl mx-auto px-6 py-10">
    <div class="grid lg:grid-cols-12 gap-8 items-start">
      <div class="lg:col-span-8">
        <div class="card p-8">
          <div class="flex items-center justify-between">
            <div>
              <div class="badge">Configurator</div>
              <h1 class="mt-4 text-3xl font-extrabold">Build Your PC</h1>
              <p class="mt-2 muted">Step through components, check compatibility, and get a live price and performance estimate.</p>
            </div>
            <div class="text-right">
              <div class="text-sm muted">Estimated performance</div>
              <div id="perfLabel" class="text-lg font-bold mt-2">Balanced</div>
              <div class="w-48 mt-2 bg-white/6 rounded-full overflow-hidden">
                <div id="perfBar" class="perf-bar" style="width:50%"></div>
              </div>
            </div>
          </div>

          <hr class="my-6 border-white/6" />

          <!-- Wizard steps -->
          <div id="wizard" class="space-y-6">
            <!-- Step template repeated -->
            <section class="step card p-4" data-step="cpu">
              <div class="flex items-center justify-between">
                <h3 class="font-semibold">1. CPU</h3>
                <div id="cpuCompat" class="muted">Socket: <span id="cpuSocket">â€”</span></div>
              </div>
              <div class="mt-3 grid md:grid-cols-2 gap-4">
                <div>
                  <select id="cpuSelect" class="w-full border rounded px-3 py-2 bg-transparent">
                    <option value="">Select CPU</option>
                  </select>
                  <div class="mt-2 text-sm muted">Pick a CPU. Socket and TDP are used for compatibility checks.</div>
                </div>
                <div>
                  <div class="text-sm muted">Selected</div>
                  <div id="cpuSummary" class="mt-2">â€”</div>
                </div>
              </div>
            </section>

            <section class="step card p-4" data-step="motherboard">
              <div class="flex items-center justify-between">
                <h3 class="font-semibold">2. Motherboard</h3>
                <div id="mbCompat" class="muted">Socket: <span id="mbSocket">â€”</span></div>
              </div>
              <div class="mt-3 grid md:grid-cols-2 gap-4">
                <div>
                  <select id="mbSelect" class="w-full border rounded px-3 py-2 bg-transparent">
                    <option value="">Select Motherboard</option>
                  </select>
                  <div class="mt-2 text-sm muted">Form factor and socket must match CPU and case.</div>
                </div>
                <div>
                  <div class="text-sm muted">Selected</div>
                  <div id="mbSummary" class="mt-2">â€”</div>
                </div>
              </div>
            </section>

            <section class="step card p-4" data-step="ram">
              <div class="flex items-center justify-between">
                <h3 class="font-semibold">3. RAM</h3>
                <div id="ramCompat" class="muted">Type: <span id="ramType">â€”</span></div>
              </div>
              <div class="mt-3 grid md:grid-cols-2 gap-4">
                <div>
                  <select id="ramSelect" class="w-full border rounded px-3 py-2 bg-transparent">
                    <option value="">Select RAM</option>
                  </select>
                  <div class="mt-2 text-sm muted">Choose capacity and speed. Check motherboard supported RAM type.</div>
                </div>
                <div>
                  <div class="text-sm muted">Selected</div>
                  <div id="ramSummary" class="mt-2">â€”</div>
                </div>
              </div>
            </section>

            <section class="step card p-4" data-step="gpu">
              <div class="flex items-center justify-between">
                <h3 class="font-semibold">4. GPU</h3>
                <div id="gpuCompat" class="muted">TDP: <span id="gpuTDP">â€”</span>W</div>
              </div>
              <div class="mt-3 grid md:grid-cols-2 gap-4">
                <div>
                  <select id="gpuSelect" class="w-full border rounded px-3 py-2 bg-transparent">
                    <option value="">Select GPU</option>
                  </select>
                  <div class="mt-2 text-sm muted">GPU TDP is used to estimate PSU requirements.</div>
                </div>
                <div>
                  <div class="text-sm muted">Selected</div>
                  <div id="gpuSummary" class="mt-2">â€”</div>
                </div>
              </div>
            </section>

            <section class="step card p-4" data-step="storage">
              <div class="flex items-center justify-between">
                <h3 class="font-semibold">5. Storage</h3>
                <div id="storageCompat" class="muted">Type: <span id="storageType">â€”</span></div>
              </div>
              <div class="mt-3 grid md:grid-cols-2 gap-4">
                <div>
                  <select id="storageSelect" class="w-full border rounded px-3 py-2 bg-transparent">
                    <option value="">Select Storage</option>
                  </select>
                  <div class="mt-2 text-sm muted">NVMe or SATA options available.</div>
                </div>
                <div>
                  <div class="text-sm muted">Selected</div>
                  <div id="storageSummary" class="mt-2">â€”</div>
                </div>
              </div>
            </section>

            <section class="step card p-4" data-step="case">
              <div class="flex items-center justify-between">
                <h3 class="font-semibold">6. Case & PSU</h3>
                <div id="caseCompat" class="muted">Form factor: <span id="caseForm">â€”</span></div>
              </div>
              <div class="mt-3 grid md:grid-cols-2 gap-4">
                <div>
                  <select id="caseSelect" class="w-full border rounded px-3 py-2 bg-transparent">
                    <option value="">Select Case & PSU</option>
                  </select>
                  <div class="mt-2 text-sm muted">PSU wattage must cover GPU + CPU + extras.</div>
                </div>
                <div>
                  <div class="text-sm muted">Selected</div>
                  <div id="caseSummary" class="mt-2">â€”</div>
                </div>
              </div>
            </section>
          </div>

          <!-- Summary & actions -->
          <div class="mt-6 flex items-center justify-between gap-4">
            <div>
              <div class="text-sm muted">Build total</div>
              <div id="totalPrice" class="text-2xl font-bold mt-1">0 DZD</div>
              <div id="compatMessage" class="mt-2 muted">Compatibility: <span id="compatStatus" class="compat-ok">Checkingâ€¦</span></div>
            </div>

            <div class="flex gap-3">
              <button id="saveBuild" class="cta">Save Build</button>
              <button id="addBuildCart" class="cta" style="background:linear-gradient(90deg,#6c5ce7,#00f0ff); color:white;">Add Build to Cart</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Right column: tips, quick specs, saved builds -->
      <aside class="lg:col-span-4 space-y-6">
        <div class="card p-4">
          <h4 class="font-semibold">Quick Tips</h4>
          <ul class="mt-3 text-sm muted space-y-2">
            <li>Start with the CPU and motherboard to ensure socket compatibility.</li>
            <li>Choose a PSU with at least 20% headroom above estimated wattage.</li>
            <li>Check case form factor (ATX/mATX/ITX) against the motherboard.</li>
          </ul>
        </div>

        <div class="card p-4">
          <h4 class="font-semibold">Saved Builds</h4>
          <div id="savedBuilds" class="mt-3 text-sm muted">No saved builds yet.</div>
        </div>

        <div class="card p-4">
          <h4 class="font-semibold">Support</h4>
          <p class="mt-2 muted text-sm">Need help? Contact our local support for custom builds and warranty options.</p>
          <a href="#contact" class="mt-3 inline-block cta">Contact Support</a>
        </div>
      </aside>
    </div>
  </main>

  <!-- Footer -->
  <footer class="mt-12">
    <div class="max-w-7xl mx-auto px-6 py-8 flex justify-between items-center muted">
      <div>Â© <span id="year"></span> ElectroStore DZ â€” Algeria</div>
      <div class="flex gap-4 text-sm">
        <a href="store.html">Back to Store</a>
        <a href="#">Privacy</a>
      </div>
    </div>
  </footer>

  <!-- JS: data, compatibility logic, live totals, save/add actions -->
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // Theme toggle (persist)
    document.getElementById('themeToggle').addEventListener('click', () => {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
      const next = current === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
    });

    // Sample component dataset with minimal compatibility metadata
    const COMPONENTS = {
      cpus: [
        { id:'cpu1', name:'Intel i7-13700K', socket:'LGA1700', tdp:125, price:75000 },
        { id:'cpu2', name:'AMD Ryzen 7 7700X', socket:'AM5', tdp:105, price:70000 },
        { id:'cpu3', name:'Intel i5-13600K', socket:'LGA1700', tdp:125, price:42000 },
      ],
      motherboards: [
        { id:'mb1', name:'ASUS ROG Strix Z790 (ATX)', socket:'LGA1700', form:'ATX', ramType:'DDR5', price:45000 },
        { id:'mb2', name:'MSI MAG B650 (ATX)', socket:'AM5', form:'ATX', ramType:'DDR5', price:38000 },
        { id:'mb3', name:'Gigabyte B660M (mATX)', socket:'LGA1700', form:'mATX', ramType:'DDR4', price:22000 },
      ],
      rams: [
        { id:'ram1', name:'16GB (2x8) DDR5 5600', type:'DDR5', price:18000 },
        { id:'ram2', name:'32GB (2x16) DDR5 6000', type:'DDR5', price:32000 },
        { id:'ram3', name:'16GB (2x8) DDR4 3200', type:'DDR4', price:9000 },
      ],
      gpus: [
        { id:'gpu1', name:'NVIDIA RTX 4080', tdp:320, price:250000 },
        { id:'gpu2', name:'AMD RX 7900 XT', tdp:300, price:220000 },
        { id:'gpu3', name:'NVIDIA RTX 4070', tdp:200, price:140000 },
      ],
      storages: [
        { id:'s1', name:'1TB NVMe SSD', type:'NVMe', price:15000 },
        { id:'s2', name:'2TB SATA SSD', type:'SATA', price:12000 },
      ],
      cases: [
        { id:'case1', name:'ATX Mid Tower + 750W PSU', form:'ATX', psu:750, price:22000 },
        { id:'case2', name:'mATX Compact + 650W PSU', form:'mATX', psu:650, price:15000 },
        { id:'case3', name:'ITX Mini + 600W PSU', form:'ITX', psu:600, price:14000 },
      ]
    };

    // Populate selects
    function populateSelect(id, list, labelFn) {
      const sel = document.getElementById(id);
      list.forEach(item => {
        const opt = document.createElement('option');
        opt.value = item.id;
        opt.textContent = labelFn ? labelFn(item) : item.name;
        sel.appendChild(opt);
      });
    }
    populateSelect('cpuSelect', COMPONENTS.cpus, i => `${i.name} â€” ${i.price.toLocaleString()} DZD`);
    populateSelect('mbSelect', COMPONENTS.motherboards, i => `${i.name} â€” ${i.price.toLocaleString()} DZD`);
    populateSelect('ramSelect', COMPONENTS.rams, i => `${i.name} â€” ${i.price.toLocaleString()} DZD`);
    populateSelect('gpuSelect', COMPONENTS.gpus, i => `${i.name} â€” ${i.price.toLocaleString()} DZD`);
    populateSelect('storageSelect', COMPONENTS.storages, i => `${i.name} â€” ${i.price.toLocaleString()} DZD`);
    populateSelect('caseSelect', COMPONENTS.cases, i => `${i.name} â€” ${i.price.toLocaleString()} DZD`);

    // State
    const state = { cpu:null, mb:null, ram:null, gpu:null, storage:null, case:null };

    // Helpers
    function findById(list, id) { return list.find(x => x.id === id) || null; }

    // Update UI summaries and compatibility
    function updateSummaries() {
      // CPU
      const cpu = findById(COMPONENTS.cpus, document.getElementById('cpuSelect').value);
      document.getElementById('cpuSummary').textContent = cpu ? `${cpu.name} â€” ${cpu.price.toLocaleString()} DZD` : 'â€”';
      document.getElementById('cpuSocket').textContent = cpu ? cpu.socket : 'â€”';

      // MB
      const mb = findById(COMPONENTS.motherboards, document.getElementById('mbSelect').value);
      document.getElementById('mbSummary').textContent = mb ? `${mb.name} â€” ${mb.price.toLocaleString()} DZD` : 'â€”';
      document.getElementById('mbSocket').textContent = mb ? mb.socket : 'â€”';

      // RAM
      const ram = findById(COMPONENTS.rams, document.getElementById('ramSelect').value);
      document.getElementById('ramSummary').textContent = ram ? `${ram.name} â€” ${ram.price.toLocaleString()} DZD` : 'â€”';
      document.getElementById('ramType').textContent = ram ? ram.type : 'â€”';

      // GPU
      const gpu = findById(COMPONENTS.gpus, document.getElementById('gpuSelect').value);
      document.getElementById('gpuSummary').textContent = gpu ? `${gpu.name} â€” ${gpu.price.toLocaleString()} DZD` : 'â€”';
      document.getElementById('gpuTDP').textContent = gpu ? gpu.tdp : 'â€”';

      // Storage
      const st = findById(COMPONENTS.storages, document.getElementById('storageSelect').value);
      document.getElementById('storageSummary').textContent = st ? `${st.name} â€” ${st.price.toLocaleString()} DZD` : 'â€”';
      document.getElementById('storageType').textContent = st ? st.type : 'â€”';

      // Case
      const cs = findById(COMPONENTS.cases, document.getElementById('caseSelect').value);
      document.getElementById('caseSummary').textContent = cs ? `${cs.name} â€” ${cs.price.toLocaleString()} DZD` : 'â€”';
      document.getElementById('caseForm').textContent = cs ? cs.form : 'â€”';

      // Update totals & compatibility
      computeTotalsAndCompatibility();
    }

    function computeTotalsAndCompatibility() {
      const cpu = findById(COMPONENTS.cpus, document.getElementById('cpuSelect').value);
      const mb = findById(COMPONENTS.motherboards, document.getElementById('mbSelect').value);
      const ram = findById(COMPONENTS.rams, document.getElementById('ramSelect').value);
      const gpu = findById(COMPONENTS.gpus, document.getElementById('gpuSelect').value);
      const st = findById(COMPONENTS.storages, document.getElementById('storageSelect').value);
      const cs = findById(COMPONENTS.cases, document.getElementById('caseSelect').value);

      let total = 0;
      [cpu, mb, ram, gpu, st, cs].forEach(x => { if (x) total += x.price; });
      document.getElementById('totalPrice').textContent = `${total.toLocaleString()} DZD`;

      // Compatibility checks
      const issues = [];
      if (cpu && mb && cpu.socket !== mb.socket) issues.push(`CPU socket (${cpu.socket}) does not match motherboard (${mb.socket})`);
      if (ram && mb && ram.type !== mb.ramType) issues.push(`RAM type (${ram.type}) not supported by motherboard (${mb.ramType})`);
      if (gpu && cs && gpu.tdp && cs.psu && (gpu.tdp + (cpu ? cpu.tdp : 0) + 150) > cs.psu) {
        // rough estimate: CPU TDP + GPU TDP + 150W for rest
        issues.push(`PSU (${cs.psu}W) may be insufficient for selected GPU and CPU`);
      }
      if (mb && cs && mb.form && cs.form && mb.form !== cs.form && !(mb.form === 'mATX' && cs.form === 'ATX')) {
        // allow mATX in ATX case
        issues.push(`Motherboard form factor (${mb.form}) may not fit case (${cs.form})`);
      }

      const compatStatus = document.getElementById('compatStatus');
      if (issues.length === 0) {
        compatStatus.textContent = 'All good';
        compatStatus.className = 'compat-ok';
      } else {
        compatStatus.textContent = 'Issues: ' + issues[0];
        compatStatus.className = 'compat-bad';
      }

      // Performance estimate (very rough)
      let perfScore = 0;
      if (cpu) perfScore += cpu.price / 1000;
      if (gpu) perfScore += gpu.price / 2000;
      if (ram) perfScore += ram.price / 5000;
      const perfPct = Math.min(95, Math.round(Math.min(100, perfScore)));
      document.getElementById('perfBar').style.width = `${Math.max(10, perfPct)}%`;
      const perfLabel = perfPct > 75 ? 'High' : perfPct > 45 ? 'Balanced' : 'Entry';
      document.getElementById('perfLabel').textContent = perfLabel;
    }

    // Wire up selects
    ['cpuSelect','mbSelect','ramSelect','gpuSelect','storageSelect','caseSelect'].forEach(id => {
      document.getElementById(id).addEventListener('change', updateSummaries);
    });

    // Save build (localStorage)
    function getBuildObject() {
      return {
        cpu: document.getElementById('cpuSelect').value || null,
        mb: document.getElementById('mbSelect').value || null,
        ram: document.getElementById('ramSelect').value || null,
        gpu: document.getElementById('gpuSelect').value || null,
        storage: document.getElementById('storageSelect').value || null,
        case: document.getElementById('caseSelect').value || null,
        savedAt: new Date().toISOString()
      };
    }

    function saveBuild() {
      const build = getBuildObject();
      const saved = JSON.parse(localStorage.getItem('savedBuilds') || '[]');
      saved.push(build);
      localStorage.setItem('savedBuilds', JSON.stringify(saved));
      renderSavedBuilds();
      alert('Build saved locally');
    }
    document.getElementById('saveBuild').addEventListener('click', saveBuild);

    function renderSavedBuilds() {
      const container = document.getElementById('savedBuilds');
      const saved = JSON.parse(localStorage.getItem('savedBuilds') || '[]');
      if (!saved.length) { container.textContent = 'No saved builds yet.'; return; }
      container.innerHTML = '';
      saved.slice().reverse().forEach((b, idx) => {
        const el = document.createElement('div');
        el.className = 'p-3 border rounded mb-2';
        const cpu = findById(COMPONENTS.cpus, b.cpu);
        const gpu = findById(COMPONENTS.gpus, b.gpu);
        el.innerHTML = `<div class="font-medium">${cpu ? cpu.name : 'â€”'} / ${gpu ? gpu.name : 'â€”'}</div>
                        <div class="text-xs muted">Saved ${new Date(b.savedAt).toLocaleString()}</div>
                        <div class="mt-2"><button class="cta" onclick='loadBuild(${idx})'>Load</button></div>`;
        container.appendChild(el);
      });
    }

    // Load build by index (reverse order)
    window.loadBuild = function(reverseIndex) {
      const saved = JSON.parse(localStorage.getItem('savedBuilds') || '[]');
      if (!saved.length) return;
      const b = saved[saved.length - 1 - reverseIndex];
      if (!b) return;
      document.getElementById('cpuSelect').value = b.cpu || '';
      document.getElementById('mbSelect').value = b.mb || '';
      document.getElementById('ramSelect').value = b.ram || '';
      document.getElementById('gpuSelect').value = b.gpu || '';
      document.getElementById('storageSelect').value = b.storage || '';
      document.getElementById('caseSelect').value = b.case || '';
      updateSummaries();
    };

    // Add build to cart (demo: increments cart counter)
    document.getElementById('addBuildCart').addEventListener('click', () => {
      // Basic validation: at least CPU and MB and GPU selected
      const cpu = document.getElementById('cpuSelect').value;
      const mb = document.getElementById('mbSelect').value;
      const gpu = document.getElementById('gpuSelect').value;
      if (!cpu || !mb || !gpu) { alert('Please select at least CPU, Motherboard, and GPU before adding to cart.'); return; }
      const cartCountEl = document.getElementById('cartCount');
      cartCountEl.textContent = String(Number(cartCountEl.textContent || '0') + 1);
      alert('Build added to cart');
    });

    // Initial render
    updateSummaries();
    renderSavedBuilds();

    // Accessibility: keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.key === 's' && (e.ctrlKey || e.metaKey)) { e.preventDefault(); saveBuild(); }
    });
  </script>
</body>
</html>
